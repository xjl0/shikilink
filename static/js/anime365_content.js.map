{"version":3,"file":"static/js/anime365_content.js","mappings":"mBACA,IAAIA,EAGAC,EACAC,EAHAC,EAA2B,EAC3BC,EAA4B,EAGhCC,OAAOC,QAAQC,UAAUC,aAAY,SAAUC,GAE3C,GAAIA,GAA4B,2BAAjBA,EAAQC,OAEnBC,cAAcX,GAEVY,SAASC,eAAe,eAAe,CAAC,IAAD,MACvC,MAAMC,EAAaF,SAASC,eAAe,cAErCE,EAA6BD,EAAYE,cAE6D,IAAD,IAA3G,GAAuE,QAAvE,EAAIJ,SAASK,uBAAuB,4BAA4BC,KAAK,UAAE,OAAnE,EAAqEC,qBAAqB,KAAKD,KAAK,GACpGhB,GAAsF,QAAnE,EAAAU,SAASK,uBAAuB,4BAA4BC,KAAK,UAAE,OAAmC,QAAnC,EAAnE,EAAqEC,qBAAqB,KAAKD,KAAK,UAAE,WAAnC,EAAnE,EAAwGE,OAAQ,SACjI,GAA2H,mBAArD,QAAnE,EAAAR,SAASK,uBAAuB,4BAA4BC,KAAK,UAAE,OAAmC,QAAnC,EAAnE,EAAqEC,qBAAqB,KAAKD,KAAK,UAAE,WAAnC,EAAnE,EAAwGG,aAAgC,CAAC,IAAD,IAC7InB,GAAsF,QAAnE,EAAAU,SAASK,uBAAuB,4BAA4BC,KAAK,UAAE,OAAmC,QAAnC,EAAnE,EAAqEC,qBAAqB,KAAKD,KAAK,UAAE,WAAnC,EAAnE,EAAwGE,OAAQ,GACvI,MACIlB,EAAmB,IAGvBF,EAAUsB,YAAW,SAASC,IAAQ,IAAD,IAKjC,GAHApB,GAAyB,OAANY,QAAM,IAANA,GAAsD,QAAhD,EAANA,EAAQH,SAASO,qBAAqB,SAASD,KAAK,UAAE,WAAhD,EAAN,EAAwDM,cAAe,EAC1FpB,GAA0B,OAANW,QAAM,IAANA,GAAsD,QAAhD,EAANA,EAAQH,SAASO,qBAAqB,SAASD,KAAK,UAAE,WAAhD,EAAN,EAAwDO,WAAY,EAEpFX,GAAcV,EAAoB,IAAMD,GAAoBC,EAAoB,GAAKD,EAAmB,GAA0B,MAArBD,EAA0B,CAEvI,MAAMwB,EAAkB,OAANX,QAAM,IAANA,OAAM,EAANA,EAAQH,SAASC,eAAe,uBAElD,GAAKa,EAyBE,CAAC,IAAD,EAECvB,IAAqBC,GAA0C,MAArBF,IAE1CU,SAASe,SAASP,KAAOlB,GAGc,QAA3C,EAAAwB,EAAUP,qBAAqB,KAAKD,KAAK,UAAE,OAA3C,EAA6CU,MAAMC,YAAY,UAA0D,KAA7CzB,EAAoBD,EAAmB,KAAa,EAAK,GAAK,IAC9I,KAjCgB,CAEZ,MAAM2B,EAAMlB,SAASmB,cAAc,OAC7BC,EAAIpB,SAASmB,cAAc,KAC3BE,EAAOrB,SAASmB,cAAc,QACpCD,EAAII,GAAK,sBACTD,EAAKE,UAAY,iCACjBH,EAAEI,MAAQ,6HACVJ,EAAEK,QAAU,WAAa,IAAD,IAEpB1B,cAAcX,GACR,OAANe,QAAM,IAANA,GAAsD,QAAhD,EAANA,EAAQH,SAASC,eAAe,8BAAsB,OAAtD,EAAwDyB,SAC/C,QAAT,EAAArC,SAAS,OAAT,EAAWqC,QACf,EACAR,EAAIS,YAAYP,GAAGO,YAAYN,GAC/BhC,EAAkB,OAANc,QAAM,IAANA,OAAM,EAANA,EAAQH,SAAS4B,KAAKD,YAAY3B,SAASmB,cAAc,UACrE9B,EAAWwC,UAAY,8rBAMvB,MAAMC,EAAkB,OAAN3B,QAAM,IAANA,OAAM,EAANA,EAAQH,SAASK,uBAAuB,mBAAmBC,KAAK,GACnEwB,EAAUC,WAClBC,aAAad,EAAKY,EAC7B,CASJ,KAAO,CAAC,IAAD,IACG,OAAN3B,QAAM,IAANA,GAAsD,QAAhD,EAANA,EAAQH,SAASC,eAAe,8BAAsB,OAAtD,EAAwDyB,SAC/C,QAAT,EAAArC,SAAS,OAAT,EAAWqC,QACf,CACAtC,EAAUsB,WAAWC,EAAM,IAC/B,GAAG,IAEP,CAER,G","sources":["chromeServices/anime365_content.ts"],"sourcesContent":["export {}\nlet timerId: string | number | NodeJS.Timeout | undefined;\nlet countCurrentTime: number = 0;\nlet countDurationTime: number = 0;\nlet styleElem: HTMLStyleElement | undefined;\nlet hrefChevronRight: string;\nchrome.runtime.onMessage.addListener(function (request) {\n    // Получаем сообщение от background что страница готова\n    if (request && request.type === 'page-rendered-anime365') {\n        //Очистим таймер если есть\n        clearInterval(timerId);\n        //Проверим наличие плеера\n        if (document.getElementById(\"videoFrame\")) {\n            const videoFrame = document.getElementById(\"videoFrame\")!;\n            // eslint-disable-next-line @typescript-eslint/consistent-type-assertions\n            const iFrame = (<HTMLIFrameElement>videoFrame).contentWindow;\n            //Пределим наличие кнопки на следующую серию\n            if (document.getElementsByClassName(\"m-select-sibling-episode\").item(0)?.getElementsByTagName(\"i\").item(1)){\n                hrefChevronRight = document.getElementsByClassName(\"m-select-sibling-episode\").item(0)?.getElementsByTagName(\"a\").item(1)?.href || \"/\";\n            }else if(document.getElementsByClassName(\"m-select-sibling-episode\").item(0)?.getElementsByTagName(\"i\").item(0)?.textContent === \"chevron_right\"){\n                hrefChevronRight = document.getElementsByClassName(\"m-select-sibling-episode\").item(0)?.getElementsByTagName(\"a\").item(0)?.href || \"/\";\n            }else{\n                hrefChevronRight = \"/\";\n            }\n            //Запустим таймер\n            timerId = setTimeout(function tick() {\n                //Получим состояние видео\n                countCurrentTime = iFrame?.document.getElementsByTagName(\"video\").item(0)?.currentTime || 0;\n                countDurationTime = iFrame?.document.getElementsByTagName(\"video\").item(0)?.duration || 0;\n                //Если до конца тайтла осталось 15 секунд покажем блок\n                if (videoFrame && countDurationTime - 15 <= countCurrentTime && countDurationTime > 0 && countCurrentTime > 0 && hrefChevronRight !== \"/\") {\n                    //Вернём наличие нашего блока\n                    const mainBlock = iFrame?.document.getElementById(\"answer_is_forty_two\");\n                    //Если блока нет\n                    if (!mainBlock) {\n                        //Созданим элементы блока\n                        const div = document.createElement('div');\n                        const a = document.createElement('a');\n                        const span = document.createElement('span');\n                        div.id = \"answer_is_forty_two\";\n                        span.innerText = \"Далее\";\n                        a.title = \"Нажмите чтобы отменить\";\n                        a.onclick = function () {\n                            //При нажатии на блок очистим таймер и удалим блок\n                            clearInterval(timerId);\n                            iFrame?.document.getElementById(\"answer_is_forty_two\")?.remove();\n                            styleElem?.remove();\n                        }\n                        div.appendChild(a).appendChild(span);\n                        styleElem = iFrame?.document.head.appendChild(document.createElement(\"style\"));\n                        styleElem!.innerHTML = \"#answer_is_forty_two{background-color: #ff6d0033; position:absolute; bottom:10%; right:5%;}\" +\n                            \"#answer_is_forty_two a{border-radius: 2px; display: block; cursor: pointer; width: 200px; height: 40px; line-height: 40px; font-size: 18px; font-family: sans-serif; text-decoration: none; color: #fff;border: 1px solid #fff;letter-spacing: 2px;text-align: center;position: relative;transition: all .35s;}\" +\n                            \"#answer_is_forty_two a:after{border-radius: 2px; position: absolute; content: \\\"\\\"; top: 0; left: 0; width: var(--width, 0); height: 100%; background: #ff6d00; transition: all .35s;}\" +\n                            \"#answer_is_forty_two a:hover{color: #fff; background: #ff6d0088;}\" +\n                            \"#answer_is_forty_two a span{position: relative; z-index: 2;}\";\n                        //Добавим блок во фрейм\n                        const container = iFrame?.document.getElementsByClassName(\"vjs-control-bar\").item(0)!;\n                        const parent = container.parentNode!\n                        parent.insertBefore(div, container)\n                    } else {\n                        //Если дошли до конца то переходим по ссылке\n                        if (countCurrentTime === countDurationTime && hrefChevronRight !== \"/\") {\n                            //Проверить возможность сохранить в память состояние плеера, после перехода на следующую серию вернуть. fullscreen, play/pause\n                            document.location.href = hrefChevronRight;\n                        }\n                        //Визуализируем счётчик\n                        mainBlock.getElementsByTagName(\"a\").item(0)?.style.setProperty(\"--width\", ((countDurationTime - countCurrentTime - 15) * 100 * -1) / 15 + \"%\");\n                    }\n                } else {\n                    iFrame?.document.getElementById(\"answer_is_forty_two\")?.remove();\n                    styleElem?.remove();\n                }\n                timerId = setTimeout(tick, 500);\n            }, 500);\n\n        }\n    }\n});"],"names":["timerId","styleElem","hrefChevronRight","countCurrentTime","countDurationTime","chrome","runtime","onMessage","addListener","request","type","clearInterval","document","getElementById","videoFrame","iFrame","contentWindow","getElementsByClassName","item","getElementsByTagName","href","textContent","setTimeout","tick","currentTime","duration","mainBlock","location","style","setProperty","div","createElement","a","span","id","innerText","title","onclick","remove","appendChild","head","innerHTML","container","parentNode","insertBefore"],"sourceRoot":""}