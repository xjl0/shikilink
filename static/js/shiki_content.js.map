{"version":3,"file":"static/js/shiki_content.js","mappings":"mBAWO,IAAKA,GAGX,SAHWA,GAAAA,EAAAA,EAAM,iBAANA,EAAAA,EAAM,qBAGjB,CAHWA,IAAAA,EAAM,KCPlB,MAQMC,EAA+B,CAACC,EAAwBC,EAAsCC,KAChG,IAJqD,IAA9CC,OAAOC,SAASC,KAAKC,QAAQ,aAAiF,IAA3DC,SAASC,uBAAuB,gBAAgBC,OAIpF,CAOlBP,EANgC,CAC5BQ,MAAO,yFACPC,YAAa,GACbC,YAAa,yHACbC,OAAQ,IAGhB,CACA,MAAMC,EAlBa,EAACd,EAAwBC,IACrCA,EAAOc,KAAOC,OAAOC,QAAQF,GAiBhBG,CAAelB,EAASC,GAC5C,GAAIa,GAAed,EAAQmB,OAASrB,EAAOsB,MAAO,CAO9ClB,EANgC,CAC5BQ,MAAOH,SAASG,MAChBC,YAAaJ,SAASc,cAAc,2BAA4BC,aAAa,WAC7EV,YAAkF,MAArEL,SAASC,uBAAuB,0BAA0Be,KAAK,GAAahB,SAASC,uBAAuB,0BAA0Be,KAAK,GAAIC,UAAYjB,SAASC,uBAAuB,0BAA0Be,KAAK,GAAIC,UAC3OX,OAAQN,SAASC,uBAAuB,YAAYe,KAAK,GAAIE,qBAAqB,OAAO,GAAGC,KAGpG,GAOyB,iBAAzBvB,OAAOC,SAASuB,MAAoD,kBAAzBxB,OAAOC,SAASuB,MAAqD,kBAAzBxB,OAAOC,SAASuB,MAHvGX,OAAOC,QAAQW,UAAUC,YAAY9B,GAOzC,MAAM+B,EAAe,CAACpB,EAAeqB,KACjC,MAAMC,EAASzB,SAAS0B,cAAc,KAOtC,OANAD,EAAOE,OAAS,SAChBF,EAAOG,UAAY,gBACnBH,EAAOtB,MAAQA,EACfsB,EAAOI,KAAO1B,EACdsB,EAAO3B,KAAO0B,EACdC,EAAOK,IAAM,+BACNL,CAAM,EAGjBhB,OAAOC,QAAQW,UAAUC,aAAY,SAASS,GAC1C,GAAIA,GAA4B,kBAAjBA,EAAQC,OACdhC,SAASiC,eAAe,yBAAwE,IAA9CrC,OAAOC,SAASC,KAAKC,QAAQ,aAA4E,IAAtDC,SAASC,uBAAuB,WAAWC,QAAsE,OAAtDF,SAASc,cAAc,2BAAoC,CAC5N,MAAMoB,EAAYC,UAAUnC,SAASc,cAAc,2BAA4BC,aAAa,YACtFqB,EAAMpC,SAAS0B,cAAc,OACnCU,EAAI5B,GAAK,sBACTR,SAASC,uBAAuB,WAAWe,KAAK,GAAIqB,YAAYD,GAAKC,YAAYd,EAAa,cAAe,wCAA0CW,IACvJlC,SAASC,uBAAuB,WAAWe,KAAK,GAAIqB,YAAYD,GAAKC,YAAYd,EAAa,cAAe,yCAA2CW,IACxJlC,SAASC,uBAAuB,WAAWe,KAAK,GAAIqB,YAAYD,GAAKC,YAAYd,EAAa,cAAe,sCAAwCW,GACzJ,CAER,G","sources":["types/DOMMessages.ts","chromeServices/shiki_content.ts"],"sourcesContent":["export type DOMMessage = {\n    type: 'GET_DOM'\n}\n\nexport type DOMMessageResponse = {\n    title: string;\n    metaContent: string;\n    description: string;\n    poster: string;\n}\n\nexport enum Sender {\n    React,\n    Content,\n}\n\nexport interface ChromeMessage {\n    from: Sender,\n    message: any\n}","import {ChromeMessage, DOMMessageResponse, Sender} from '../types';\n\ntype MessageResponse = (response?: any) => void\n\nconst validateSender = (message: ChromeMessage, sender: chrome.runtime.MessageSender) => {\n    return sender.id === chrome.runtime.id;\n}\n\nconst isPossibleLink = (): boolean => {\n    return window.location.href.indexOf(\"/animes/\") === -1 || document.getElementsByClassName(\"c-info-right\").length === 0;\n}\n\nconst messagesFromReactAppListener = (message: ChromeMessage, sender: chrome.runtime.MessageSender, response: MessageResponse) => {\n    if (isPossibleLink()) {\n        const res: DOMMessageResponse = {\n            title: \"Не найдено аниме\",\n            metaContent: \"\",\n            description: \"Вы не на странице аниме\",\n            poster: \"\"\n        };\n        response(res)\n    }\n    const isValidDate = validateSender(message, sender)\n    if (isValidDate && message.from === Sender.React) {\n        const res: DOMMessageResponse = {\n            title: document.title,\n            metaContent: document.querySelector(\"meta[itemprop=headline]\")!.getAttribute('content')!,\n            description: document.getElementsByClassName(\"b-text_with_paragraphs\").item(1) != null ? document.getElementsByClassName(\"b-text_with_paragraphs\").item(1)!.innerHTML : document.getElementsByClassName(\"b-text_with_paragraphs\").item(0)!.innerHTML,\n            poster: document.getElementsByClassName(\"c-poster\").item(0)!.getElementsByTagName(\"img\")[0].src\n        };\n        response(res)\n    }\n}\n\nconst main = () => {\n    chrome.runtime.onMessage.addListener(messagesFromReactAppListener);\n}\n\nif (window.location.host === \"shikimori.me\" || window.location.host === \"shikimori.one\" || window.location.host === \"shikimori.org\") {\n    main();\n}\n\nconst generateLink = (title: string, link: string): HTMLAnchorElement => {\n    const button = document.createElement('a');\n    button.target = \"_blank\";\n    button.className = \"b-link_button\";\n    button.title = title;\n    button.text = title;\n    button.href = link;\n    button.rel = \"nofollow noopener noreferrer\";\n    return button\n}\n\nchrome.runtime.onMessage.addListener(function(request) {\n    if (request && request.type === 'page-rendered') {\n        if (!document.getElementById(\"answer_is_forty_two\") && window.location.href.indexOf(\"/animes/\") !== -1 && document.getElementsByClassName('c-image').length !== 0 && document.querySelector(\"meta[itemprop=headline]\") !== null){\n            const linkAnime = encodeURI(document.querySelector(\"meta[itemprop=headline]\")!.getAttribute('content')!);\n            const div = document.createElement('div');\n            div.id = \"answer_is_forty_two\";\n            document.getElementsByClassName('c-image').item(0)!.appendChild(div).appendChild(generateLink(\"anime365.ru\", \"https://anime365.ru/catalog/search?q=\" + linkAnime));\n            document.getElementsByClassName('c-image').item(0)!.appendChild(div).appendChild(generateLink(\"anime365.ru\", \"https://anime-365.ru/catalog/search?q=\" + linkAnime));\n            document.getElementsByClassName('c-image').item(0)!.appendChild(div).appendChild(generateLink(\"AnimeGo.org\", \"https://animego.org/search/anime?q=\" + linkAnime));\n        }\n    }\n});\n\n"],"names":["Sender","messagesFromReactAppListener","message","sender","response","window","location","href","indexOf","document","getElementsByClassName","length","title","metaContent","description","poster","isValidDate","id","chrome","runtime","validateSender","from","React","querySelector","getAttribute","item","innerHTML","getElementsByTagName","src","host","onMessage","addListener","generateLink","link","button","createElement","target","className","text","rel","request","type","getElementById","linkAnime","encodeURI","div","appendChild"],"sourceRoot":""}